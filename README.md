# Reed Solomon in Pure C
## Introduction
This project implements Reed Solomon Erasure Coding in pure C. It is ported from https://github.com/klauspost/reedsolomon (currently without SIMD instructions, but I'll add them later). Though aimed at working in Linux Kernel, it's also functional in user space programs.

## API
The API is simple and straightforward. Only 4 basic functions are implemented, as follows:
```c
// Initialize.
int rs_init(struct reed_solomon *rs, uint8_t data_shard, uint8_t parity_shard);

// Encode data shards into corresponding parity shards.
// To prevent unnecessary memory allocation, This function will not
// automatically allocate memory space for you. You should allocate
// the space for storing parity shards yourself, and put the allocated pointer in
// to the `shards` array.
// The `shard_size` parameter indicates the length of every shard, and is arbitrary.
// However, all shards should have equal size.
void rs_encode(const struct reed_solomon *rs, uint8_t * const * shards, int shard_size);

// Reconstruct data shards from available shards. This function will
// not allocate memory for missing shards; you should allocate them yourself.
// Valid shards are marked by the bitset `valid_shards`, and will be used for reconstructing.
// For example, for a 10 data + 3 parity configuration, if block 1, 5, 10 are missing, valid_shards should
// be 0b1101111011101.
// `shard_size` is same as above.
// Note that this will only reconstruct data shards.
int rs_reconstruct(const struct reed_solomon *rs, uint8_t * const * shards, unsigned long valid_shards, int shard_size);

// Destroys the encoder. Don't forget to destroy it to release the cache generated byr`construct`.
void rs_destroy(struct reed_solomon* rs);
```

## Testing
Refer to main.cpp for testing code.
```bash
mkdir build
cd build
cmake ..
make
./reed_solomon_c
```

## TODO
- [ ] Add more extensive tests and benchmark.
- [ ] Reimplement a inversion cache tree rather than using radix-tree from Linux Kernel to remove junk code in `common.h`.
- [ ] Port SIMD accleration code.
- [ ] Provide a flag to reconstruct parity shards.
